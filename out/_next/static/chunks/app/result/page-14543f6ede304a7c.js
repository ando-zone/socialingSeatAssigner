(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[834],{3160:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(5155),l=s(2115),n=s(5695),i=s(2998),a=s(2945);function d(e){let{groups:t,participants:s,onPrint:l}=e,n=(()=>{let e=[],s=Math.ceil(Math.sqrt(t.length));return t.forEach((t,r)=>{let l=Math.floor(r/s);e.push({id:t.id,x:r%s*400+100,y:320*l+100,width:200,height:120,seats:(e=>{let t=[];return e<=2?(t.push({x:100,y:-20,angle:0,side:"top"}),e>1&&t.push({x:100,y:140,angle:180,side:"bottom"})):e<=4?(t.push({x:100,y:-20,angle:0,side:"top"}),t.push({x:100,y:140,angle:180,side:"bottom"}),e>2&&t.push({x:-20,y:60,angle:90,side:"left"}),e>3&&t.push({x:220,y:60,angle:-90,side:"right"})):e<=6?(t.push({x:60,y:-20,angle:0,side:"top"}),t.push({x:140,y:-20,angle:0,side:"top"}),t.push({x:60,y:140,angle:180,side:"bottom"}),t.push({x:140,y:140,angle:180,side:"bottom"}),e>4&&t.push({x:-20,y:60,angle:90,side:"left"}),e>5&&t.push({x:220,y:60,angle:-90,side:"right"})):(t.push({x:40,y:-20,angle:0,side:"top"}),t.push({x:100,y:-20,angle:0,side:"top"}),t.push({x:160,y:-20,angle:0,side:"top"}),t.push({x:40,y:140,angle:180,side:"bottom"}),t.push({x:100,y:140,angle:180,side:"bottom"}),t.push({x:160,y:140,angle:180,side:"bottom"}),e>6&&t.push({x:-20,y:60,angle:90,side:"left"}),e>7&&t.push({x:220,y:60,angle:-90,side:"right"})),t.slice(0,e)})(t.members.length)})}),e})(),i=Math.max(...n.map(e=>e.x+e.width))+100,a=Math.max(...n.map(e=>e.y+e.height))+100;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"좌석 배치도"}),(0,r.jsxs)("button",{onClick:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a1 1 0 001-1v-4a1 1 0 00-1-1H9a1 1 0 00-1 1v4a1 1 0 001 1zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"배치도 출력"]})]}),(0,r.jsx)("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-6 shadow-lg",children:(0,r.jsxs)("svg",{width:i,height:a,viewBox:"0 0 ".concat(i," ").concat(a),className:"w-full h-auto border border-gray-100",style:{minHeight:"600px"},children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:(0,r.jsx)("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#f0f0f0",strokeWidth:"0.5"})}),(0,r.jsx)("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:(0,r.jsx)("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"#00000020"})})]}),(0,r.jsx)("rect",{width:i,height:a,fill:"url(#grid)"}),n.map(e=>{let s=t.find(t=>t.id===e.id);return s?(0,r.jsxs)("g",{transform:"translate(".concat(e.x,", ").concat(e.y,")"),children:[(0,r.jsx)("rect",{x:0,y:0,width:e.width,height:e.height,fill:"#8B4513",stroke:"#654321",strokeWidth:"2",rx:"8",filter:"url(#shadow)"}),(0,r.jsx)("rect",{x:8,y:8,width:e.width-16,height:e.height-16,fill:"#A0522D",rx:"4",opacity:"0.3"}),(0,r.jsxs)("text",{x:e.width/2,y:e.height/2-5,textAnchor:"middle",className:"text-sm font-bold fill-white",style:{fontSize:"14px"},children:["Table ",s.id]}),(0,r.jsxs)("text",{x:e.width/2,y:e.height/2+10,textAnchor:"middle",className:"text-xs fill-white opacity-80",style:{fontSize:"10px"},children:[s.members.length,"명"]}),e.seats.map((e,t)=>{let l=s.members[t];return l?(0,r.jsxs)("g",{transform:"translate(".concat(e.x,", ").concat(e.y,")"),children:[(0,r.jsx)("rect",{x:-20,y:-20,width:40,height:40,fill:"male"===l.gender?"#3B82F6":"#EC4899",stroke:"male"===l.gender?"#1D4ED8":"#BE185D",strokeWidth:"2",rx:"6",filter:"url(#shadow)"}),"top"===e.side&&(0,r.jsx)("rect",{x:-16,y:-28,width:32,height:"6",fill:"male"===l.gender?"#1D4ED8":"#BE185D",rx:"3"}),"bottom"===e.side&&(0,r.jsx)("rect",{x:-16,y:22,width:32,height:"6",fill:"male"===l.gender?"#1D4ED8":"#BE185D",rx:"3"}),"left"===e.side&&(0,r.jsx)("rect",{x:-28,y:-16,width:"6",height:32,fill:"male"===l.gender?"#1D4ED8":"#BE185D",rx:"3"}),"right"===e.side&&(0,r.jsx)("rect",{x:22,y:-16,width:"6",height:32,fill:"male"===l.gender?"#1D4ED8":"#BE185D",rx:"3"}),(0,r.jsx)("text",{x:0,y:5,textAnchor:"middle",className:"text-xs font-medium fill-white",style:{fontSize:"11px"},children:l.name}),(0,r.jsx)("text",{x:0,y:-8,textAnchor:"middle",className:"text-xs fill-white",style:{fontSize:"12px"},children:"male"===l.gender?"♂":"♀"})]},t):null})]},e.id):null}),(0,r.jsxs)("g",{transform:"translate(20, ".concat(a-80,")"),children:[(0,r.jsx)("rect",{x:0,y:0,width:"200",height:"60",fill:"white",stroke:"#ccc",strokeWidth:"1",rx:"4",filter:"url(#shadow)"}),(0,r.jsx)("text",{x:10,y:20,className:"text-sm font-bold fill-gray-800",style:{fontSize:"12px"},children:"범례"}),(0,r.jsx)("rect",{x:10,y:25,width:"20",height:"20",fill:"#3B82F6",stroke:"#1D4ED8",strokeWidth:"1",rx:"3"}),(0,r.jsx)("text",{x:35,y:38,className:"text-xs fill-gray-700",style:{fontSize:"10px"},children:"남성"}),(0,r.jsx)("rect",{x:80,y:25,width:"20",height:"20",fill:"#EC4899",stroke:"#BE185D",strokeWidth:"1",rx:"3"}),(0,r.jsx)("text",{x:105,y:38,className:"text-xs fill-gray-700",style:{fontSize:"10px"},children:"여성"})]})]})}),(0,r.jsx)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800 mb-2",children:["테이블 ",e.id]}),(0,r.jsx)("div",{className:"space-y-1",children:e.members.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("span",{className:"w-3 h-3 rounded-full ".concat("male"===e.gender?"bg-blue-500":"bg-pink-500")}),(0,r.jsx)("span",{children:e.name}),(0,r.jsxs)("span",{className:"text-gray-500",children:["(","extrovert"===e.mbti?"E":"I",")"]})]},e.id))})]},e.id))})]})}function o(){var e,t;let s=(0,n.useRouter)(),[o,c]=(0,l.useState)(null),[m,x]=(0,l.useState)([]),[u,h]=(0,l.useState)({}),[g,b]=(0,l.useState)(null),[p,f]=(0,l.useState)({name:"",gender:"male",mbti:"extrovert"}),[j,v]=(0,l.useState)(null),[y,N]=(0,l.useState)(null),[w,C]=(0,l.useState)("groups"),[D,M]=(0,l.useState)(null),[S,k]=(0,l.useState)(null),[B,E]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=localStorage.getItem("groupingResult"),t=localStorage.getItem("participants"),r=localStorage.getItem("exitedParticipants");if(e&&t){let s=JSON.parse(e),l=JSON.parse(t);r&&h(JSON.parse(r));let n=(0,i.Nh)(l,s.round||1);c(s),x(n),localStorage.setItem("participants",JSON.stringify(n))}else s.push("/")},[s]),(0,l.useEffect)(()=>{let e=()=>{E(window.innerWidth<=768||"ontouchstart"in window)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let I=(e,t,s)=>{let r=new Set;return Object.entries(e.meetingsByRound).forEach(e=>{let[t,l]=e;parseInt(t)<s&&l.forEach(e=>r.add(e))}),r.has(t.id)},R=(e,t)=>{if(!o)throw Error("Result is null");let s=e.map(e=>{let s=e.members.filter(e=>"male"===e.gender).length,r=e.members.filter(e=>"female"===e.gender).length,l=e.members.filter(e=>"extrovert"===e.mbti).length,n=e.members.filter(e=>"introvert"===e.mbti).length,i=0;for(let s=0;s<e.members.length;s++)for(let r=s+1;r<e.members.length;r++){let l=t.find(t=>t.id===e.members[s].id),n=t.find(t=>t.id===e.members[r].id);l&&n&&!I(l,n,o.round||1)&&i++}return{...e,maleCount:s,femaleCount:r,extrovertCount:l,introvertCount:n,newMeetingsCount:i}}),r=s.reduce((e,t)=>e+t.newMeetingsCount,0),l=t.length,n=0;s.forEach(e=>{if(e.members.length>0){let t=1-Math.abs(e.maleCount-e.femaleCount)/e.members.length;n+=t}});let i=s.length>0?n/s.length:0,a=0;s.forEach(e=>{if(e.members.length>0){let t=1-Math.abs(e.extrovertCount-e.introvertCount)/e.members.length;a+=t}});let d=s.length>0?a/s.length:0;return{groups:s,round:o.round,summary:{totalGroups:s.length,avgGroupSize:s.length>0?l/s.length:0,genderBalanceScore:Math.round(100*i),mbtiBalanceScore:Math.round(100*d),newMeetingsCount:r}}},O=()=>{f({name:"",gender:"male",mbti:"extrovert"}),b(null)},z=(e,t,s,r)=>{var l,n,i,d;if(!o)return;let u=o.groups.map(l=>{if(l.id===t){let t=l.members.map(t=>{var l;return t.id===e?null==(l=o.groups.find(e=>e.id===r))?void 0:l.members.find(e=>e.id===s):t});return{...l,members:t}}if(l.id===r){let r=l.members.map(r=>{var l;return r.id===s?null==(l=o.groups.find(e=>e.id===t))?void 0:l.members.find(t=>t.id===e):r});return{...l,members:r}}return l}),h=o.round||1,g=m.map(l=>{var n,i;let a={...l};if(l.id===e){let t=[...l.groupHistory];t.length>0&&(t[t.length-1]=r),a.groupHistory=t;let s={...l.meetingsByRound};s[h]||(s[h]=[]);let i=((null==(n=u.find(e=>e.id===r))?void 0:n.members)||[]).filter(t=>t.id!==e).map(e=>e.id);s[h]=i,a.meetingsByRound=s}else if(l.id===s){let e=[...l.groupHistory];e.length>0&&(e[e.length-1]=t),a.groupHistory=e;let r={...l.meetingsByRound};r[h]||(r[h]=[]);let n=((null==(i=u.find(e=>e.id===t))?void 0:i.members)||[]).filter(e=>e.id!==s).map(e=>e.id);r[h]=n,a.meetingsByRound=r}else{let e={...l.meetingsByRound};e[h]||(e[h]=[]);let t=u.find(e=>e.members.some(e=>e.id===l.id));if(t){let s=t.members.filter(e=>e.id!==l.id).map(e=>e.id);e[h]=s}a.meetingsByRound=e}return a}),b=R(u,g);c(b),x(g),localStorage.setItem("groupingResult",JSON.stringify(b)),localStorage.setItem("participants",JSON.stringify(g));let p=null==(n=o.groups.find(e=>e.id===t))||null==(l=n.members.find(t=>t.id===e))?void 0:l.name,f=null==(d=o.groups.find(e=>e.id===r))||null==(i=d.members.find(e=>e.id===s))?void 0:i.name;N("".concat(p," ↔ ").concat(f," 위치 변경 완료!")),(0,a.$p)("swap","".concat(p," ↔ ").concat(f," 위치 변경")),setTimeout(()=>N(null),3e3)},A=e=>{e.preventDefault()},G=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600",H=e=>e>=80?"우수":e>=60?"보통":"개선필요";return o?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[y&&(0,r.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 ease-in-out",children:(0,r.jsxs)("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"✅"}),(0,r.jsx)("span",{className:"font-medium",children:y})]})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:[o.round,"라운드 그룹 배치 결과"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"최적화된 그룹 배치가 완료되었습니다"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md mb-8",children:(0,r.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,r.jsxs)("button",{onClick:()=>C("groups"),className:"flex-1 py-4 px-6 text-center font-medium transition-colors ".concat("groups"===w?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"text-lg mr-2",children:"\uD83D\uDC65"}),"그룹 결과"]}),(0,r.jsxs)("button",{onClick:()=>C("seating"),className:"flex-1 py-4 px-6 text-center font-medium transition-colors ".concat("seating"===w?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"text-lg mr-2",children:"\uD83E\uDE91"}),"좌석 배치도"]}),(0,r.jsxs)("button",{onClick:()=>C("stats"),className:"flex-1 py-4 px-6 text-center font-medium transition-colors ".concat("stats"===w?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"text-lg mr-2",children:"\uD83D\uDCCA"}),"참가자 통계"]})]})}),"groups"===w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"배치 요약"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.summary.totalGroups}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"총 그룹 수"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:o.summary.newMeetingsCount}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"새로운 만남"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold ".concat(G(o.summary.genderBalanceScore)),children:[o.summary.genderBalanceScore,"%"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"성별 균형"}),(0,r.jsx)("div",{className:"text-xs ".concat(G(o.summary.genderBalanceScore)),children:H(o.summary.genderBalanceScore)})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold ".concat(G(o.summary.mbtiBalanceScore)),children:[o.summary.mbtiBalanceScore,"%"]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"MBTI 균형"}),(0,r.jsx)("div",{className:"text-xs ".concat(G(o.summary.mbtiBalanceScore)),children:H(o.summary.mbtiBalanceScore)})]})]})]}),(0,r.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"text-blue-400 text-lg",children:"\uD83D\uDD04"})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("strong",{children:"위치 변경:"}),B?" 첫 번째 참가자를 터치하고, 바꿀 다른 참가자를 터치하면 두 사람의 위치가 바뀝니다.":" 참가자를 드래그해서 다른 참가자에게 드롭하면 두 사람의 위치가 바뀝니다."]}),(0,r.jsxs)("p",{className:"text-xs text-blue-600",children:["\uD83D\uDCDD ",(0,r.jsx)("strong",{children:"업데이트되는 상태:"})," 그룹 구성, 성별/MBTI 통계, 새로운 만남 수, 그룹 히스토리"]}),S&&(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,r.jsxs)("p",{className:"text-xs text-orange-600",children:["\uD83C\uDFAF ",(0,r.jsx)("strong",{children:"선택됨:"})," ",null==o||null==(t=o.groups.find(e=>e.members.some(e=>e.id===S.id)))||null==(e=t.members.find(e=>e.id===S.id))?void 0:e.name," (그룹 ",S.groupId,")"]}),(0,r.jsx)("button",{onClick:()=>{k(null),N("선택이 취소되었습니다."),setTimeout(()=>N(null),2e3)},className:"text-xs bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded ml-2",children:"취소"})]})]})})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:o.groups.filter(e=>e.members.length>0).map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["그룹 ",e.id]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[e.members.length,"명"]})]}),(0,r.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded-md",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"성별 비율"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["남 ",e.maleCount," \xb7 여 ",e.femaleCount]})]}),(0,r.jsxs)("div",{className:"flex h-4 bg-gray-200 rounded-full overflow-hidden",children:[e.maleCount>0&&(0,r.jsx)("div",{className:"bg-blue-500 flex items-center justify-center text-white text-xs font-medium transition-all duration-500",style:{width:"".concat(e.maleCount/e.members.length*100,"%")},children:e.maleCount>0&&e.members.length>3&&(0,r.jsx)("span",{children:e.maleCount})}),e.femaleCount>0&&(0,r.jsx)("div",{className:"bg-pink-500 flex items-center justify-center text-white text-xs font-medium transition-all duration-500",style:{width:"".concat(e.femaleCount/e.members.length*100,"%")},children:e.femaleCount>0&&e.members.length>3&&(0,r.jsx)("span",{children:e.femaleCount})})]}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsxs)("span",{children:["남성 ",Math.round(e.maleCount/e.members.length*100),"%"]}),(0,r.jsxs)("span",{children:["여성 ",Math.round(e.femaleCount/e.members.length*100),"%"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"MBTI 비율"}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["외향 ",e.extrovertCount," \xb7 내향 ",e.introvertCount]})]}),(0,r.jsxs)("div",{className:"flex h-4 bg-gray-200 rounded-full overflow-hidden",children:[e.extrovertCount>0&&(0,r.jsx)("div",{className:"bg-orange-500 flex items-center justify-center text-white text-xs font-medium transition-all duration-500",style:{width:"".concat(e.extrovertCount/e.members.length*100,"%")},children:e.extrovertCount>0&&e.members.length>3&&(0,r.jsx)("span",{children:e.extrovertCount})}),e.introvertCount>0&&(0,r.jsx)("div",{className:"bg-purple-500 flex items-center justify-center text-white text-xs font-medium transition-all duration-500",style:{width:"".concat(e.introvertCount/e.members.length*100,"%")},children:e.introvertCount>0&&e.members.length>3&&(0,r.jsx)("span",{children:e.introvertCount})})]}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsxs)("span",{children:["외향형 ",Math.round(e.extrovertCount/e.members.length*100),"%"]}),(0,r.jsxs)("span",{children:["내향형 ",Math.round(e.introvertCount/e.members.length*100),"%"]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-xs pt-2 border-t border-gray-300",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-gray-600 mr-1",children:"성별 균형:"}),(0,r.jsx)("span",{className:"font-medium ".concat(1>=Math.abs(e.maleCount-e.femaleCount)?"text-green-600":2>=Math.abs(e.maleCount-e.femaleCount)?"text-yellow-600":"text-red-600"),children:1>=Math.abs(e.maleCount-e.femaleCount)?"우수":2>=Math.abs(e.maleCount-e.femaleCount)?"보통":"개선필요"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-gray-600 mr-1",children:"MBTI 균형:"}),(0,r.jsx)("span",{className:"font-medium ".concat(1>=Math.abs(e.extrovertCount-e.introvertCount)?"text-green-600":2>=Math.abs(e.extrovertCount-e.introvertCount)?"text-yellow-600":"text-red-600"),children:1>=Math.abs(e.extrovertCount-e.introvertCount)?"우수":2>=Math.abs(e.extrovertCount-e.introvertCount)?"보통":"개선필요"})]})]})]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[e.members.map(t=>{var s;let l=m.find(e=>e.id===t.id),n=(null==l||null==(s=l.groupHistory)?void 0:s.slice(0,-1))||[],i=(null==j?void 0:j.id)===t.id,a=(null==S?void 0:S.id)===t.id,d=S&&S.id!==t.id&&S.groupId!==e.id;return(0,r.jsxs)("div",{draggable:!B,onDragStart:B?void 0:()=>{v({id:t.id,fromGroupId:e.id})},onDragOver:B?void 0:A,onDrop:B?void 0:()=>((e,t)=>{if(j){if(j.id===e)return void v(null);if(j.fromGroupId===t){N("❌ 같은 그룹 내에서는 자리 바꾸기가 불가능합니다."),setTimeout(()=>N(null),3e3),v(null);return}z(j.id,j.fromGroupId,e,t),v(null)}})(t.id,e.id),onClick:B?()=>((e,t)=>{if(S){if(S.id===e){k(null),N("선택이 취소되었습니다."),setTimeout(()=>N(null),2e3);return}if(S.groupId===t){N("❌ 같은 그룹 내에서는 자리 바꾸기가 불가능합니다."),setTimeout(()=>N(null),3e3),k(null);return}z(S.id,S.groupId,e,t),k(null)}else k({id:e,groupId:t}),N("\uD83D\uDCA1 이제 바꿀 다른 참가자를 선택해주세요.")})(t.id,e.id):void 0,className:"\n                        flex items-center justify-between p-2 border border-gray-200 rounded transition-all duration-200\n                        ".concat(B?"cursor-pointer":"cursor-move","\n                        ").concat(i?"opacity-50 scale-95 border-blue-400 bg-blue-50":"","\n                        ").concat(a?"border-orange-500 bg-orange-100 shadow-lg ring-2 ring-orange-300":"","\n                        ").concat(d?"border-green-500 bg-green-100 hover:border-green-600 hover:bg-green-200 shadow-lg ring-2 ring-green-300":"","\n                        ").concat(!i&&!a&&!d?"hover:border-blue-300 hover:bg-blue-50":"","\n                        ").concat(j&&j.id!==t.id&&j.fromGroupId!==e.id?"border-green-300 bg-green-50 hover:border-green-400 hover:bg-green-100 shadow-md":"","\n                      "),title:a?"선택됨 - 다시 터치하면 선택 취소":d?"".concat(t.name,"과 위치 바꾸기"):B?"터치해서 선택":j&&j.id!==t.id?"".concat(t.name,"과 위치 바꾸기"):"드래그해서 다른 사람과 위치 바꾸기",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:t.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["male"===t.gender?"남성":"여성"," \xb7 "," ","extrovert"===t.mbti?"외향":"내향"]}),(0,r.jsxs)("div",{className:"text-xs text-blue-600",children:["현재 그룹: ",e.id]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,r.jsx)("div",{className:"text-orange-500 text-sm font-bold animate-pulse",children:"✅"}),d&&(0,r.jsx)("div",{className:"text-green-500 text-sm font-bold animate-bounce",children:"\uD83D\uDD04"}),n.length>0&&(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["이전: ",n.slice(-3).join(", ")]}),!a&&!d&&(0,r.jsx)("div",{className:"text-gray-400 text-sm",children:"⋮⋮"})]})]},t.id)}),g===e.id?(0,r.jsxs)("div",{className:"p-3 bg-blue-50 border-2 border-blue-200 rounded-lg",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"새 참가자 추가"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"이름",value:p.name,onChange:e=>f({...p,name:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("select",{value:p.gender,onChange:e=>f({...p,gender:e.target.value}),className:"border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"male",children:"남성"}),(0,r.jsx)("option",{value:"female",children:"여성"})]}),(0,r.jsxs)("select",{value:p.mbti,onChange:e=>f({...p,mbti:e.target.value}),className:"border border-gray-300 rounded-md px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"extrovert",children:"외향형"}),(0,r.jsx)("option",{value:"introvert",children:"내향형"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>(e=>{if(!p.name.trim()||!o)return;let t=o.groups.find(t=>t.id===e);if(!t)return;let s=t.members.map(e=>e.id),r=o.round||1,l={id:Date.now().toString(),name:p.name.trim(),gender:p.gender,mbti:p.mbti,meetingsByRound:{[r]:[...s]},allMetPeople:[...s],groupHistory:[e]},n=m.map(e=>{if(s.includes(e.id)){let t={...e.meetingsByRound};t[r]||(t[r]=[]),t[r].includes(l.id)||t[r].push(l.id);let s=[...e.allMetPeople];return s.includes(l.id)||s.push(l.id),{...e,meetingsByRound:t,allMetPeople:s}}return e});n.push(l);let i=o.groups.map(t=>{if(t.id===e){let e=[...t.members,l],s=e.filter(e=>"male"===e.gender).length,r=e.filter(e=>"female"===e.gender).length,n=e.filter(e=>"extrovert"===e.mbti).length,i=e.filter(e=>"introvert"===e.mbti).length;return{...t,members:e,maleCount:s,femaleCount:r,extrovertCount:n,introvertCount:i}}return t}),d=0;i.forEach(e=>{for(let t=0;t<e.members.length;t++)for(let s=t+1;s<e.members.length;s++){let r=n.find(s=>s.id===e.members[t].id),l=n.find(t=>t.id===e.members[s].id);r&&l&&!I(r,l,o.round||1)&&d++}});let u=R(i,n);c(u),x(n),localStorage.setItem("groupingResult",JSON.stringify(u)),localStorage.setItem("participants",JSON.stringify(n)),(0,a.$p)("participant_add_result","그룹 ".concat(e,"에 ").concat(l.name," 추가")),f({name:"",gender:"male",mbti:"extrovert"}),b(null)})(e.id),disabled:!p.name.trim(),className:"flex-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white font-medium py-2 px-3 rounded-md text-sm",children:"추가"}),(0,r.jsx)("button",{onClick:O,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-3 rounded-md text-sm",children:"취소"})]})]})]}):(0,r.jsx)("button",{onClick:()=>b(e.id),className:"w-full p-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-400 hover:text-blue-500 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("span",{className:"text-lg mr-1",children:"+"}),(0,r.jsx)("span",{className:"text-sm",children:"참가자 추가"})]})})]}),(0,r.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"text-xs text-green-600",children:["새로운 만남: ",e.newMeetingsCount,"쌍"]})})]},e.id))})]}),"seating"===w&&o&&(0,r.jsx)(d,{groups:o.groups,participants:m,onPrint:()=>window.print()}),"stats"===w&&(0,r.jsx)("div",{className:"space-y-6",children:(()=>{let e=m.map(e=>{let t=(e=>{if(!o)return[];let t=m.find(t=>t.id===e),s=o.round||1,r=new Set;return Object.entries((null==t?void 0:t.meetingsByRound)||{}).forEach(e=>{let[t,l]=e;parseInt(t)<s&&l.forEach(e=>r.add(e))}),Array.from(r)})(e.id),s=(e=>{if(!o)return[];let t=m.find(t=>t.id===e),s=o.round||1;return(null==t?void 0:t.meetingsByRound[s])||[]})(e.id),r=new Set;Object.values(e.meetingsByRound).forEach(e=>{e.forEach(e=>r.add(e))});let l=r.size,n=JSON.parse(localStorage.getItem("exitedParticipants")||"{}"),i=Array.from(r).filter(t=>{let s=m.find(e=>e.id===t);if(s)return s.gender!==e.gender;let r=n[t];return!!r&&r.gender!==e.gender}).length,a=s.filter(e=>!t.includes(e)).length,d=null==o?void 0:o.groups.find(t=>t.members.some(t=>t.id===e.id));return{...e,totalMet:l,oppositeMet:i,newInCurrentRound:a,currentGroupId:null==d?void 0:d.id,previousMeetings:t,currentRoundMeetings:s}}),t=e.reduce((e,t)=>(e[t.totalMet]=(e[t.totalMet]||0)+1,e),{}),s=e.reduce((e,t)=>(e[t.oppositeMet]=(e[t.oppositeMet]||0)+1,e),{}),l=Math.max(...e.map(e=>e.totalMet),0),n=Math.max(...e.map(e=>e.oppositeMet),0),i=Math.max(...Object.values(t),...Object.values(s),1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,r.jsx)("span",{className:"text-blue-500 mr-2",children:"\uD83D\uDC65"}),"전체 만남 수 분포"]}),(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:l+1},(e,t)=>t).map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 text-sm text-gray-600",children:[e,"명:"]}),(0,r.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-6 relative",children:(0,r.jsx)("div",{className:"bg-blue-500 h-6 rounded-full transition-all duration-500 flex items-center justify-end pr-2",style:{width:"".concat((t[e]||0)/i*100,"%")},children:(0,r.jsx)("span",{className:"text-white text-xs font-medium",children:t[e]||0})})})]},e))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,r.jsx)("span",{className:"text-pink-500 mr-2",children:"\uD83D\uDC95"}),"이성 만남 수 분포"]}),(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:n+1},(e,t)=>t).map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"w-16 text-sm text-gray-600",children:[e,"명:"]}),(0,r.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-6 relative",children:(0,r.jsx)("div",{className:"bg-pink-500 h-6 rounded-full transition-all duration-500 flex items-center justify-end pr-2",style:{width:"".concat((s[e]||0)/i*100,"%")},children:(0,r.jsx)("span",{className:"text-white text-xs font-medium",children:s[e]||0})})})]},e))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,r.jsx)("span",{className:"text-green-500 mr-2",children:"\uD83D\uDC64"}),"개별 참가자 상세 정보"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"참가자를 클릭하면 만난 사람들 목록을 확인할 수 있습니다."}),(()=>{let t=e.filter(e=>"male"===e.gender).sort((e,t)=>e.name.localeCompare(t.name,"ko")),s=e.filter(e=>"female"===e.gender).sort((e,t)=>e.name.localeCompare(t.name,"ko"));return(0,r.jsxs)("div",{className:"space-y-8",children:[t.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-4 pb-2 border-b border-blue-200",children:[(0,r.jsx)("span",{className:"text-blue-600 text-xl mr-3",children:"\uD83D\uDC68"}),(0,r.jsxs)("h4",{className:"text-lg font-semibold text-blue-800",children:["남성 참가자 (",t.length,"명)"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>{var t,s;return(0,r.jsxs)("div",{onClick:()=>M(D===e.id?null:e.id),className:"border border-blue-200 rounded-lg p-4 hover:bg-blue-50 cursor-pointer transition-colors",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h5",{className:"font-medium text-gray-800",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:["남성 \xb7 ","extrovert"===e.mbti?"외향":"내향"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,r.jsxs)("div",{className:"text-center p-2 bg-blue-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-blue-600",children:e.totalMet}),(0,r.jsx)("div",{className:"text-gray-600",children:"전체 만남"})]}),(0,r.jsxs)("div",{className:"text-center p-2 bg-pink-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-pink-600",children:e.oppositeMet}),(0,r.jsx)("div",{className:"text-gray-600",children:"이성 만남"})]}),(0,r.jsxs)("div",{className:"text-center p-2 bg-green-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-green-600",children:e.newInCurrentRound}),(0,r.jsx)("div",{className:"text-gray-600",children:"이번 라운드"})]})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["현재 그룹: ",e.currentGroupId||"없음"]}),D===e.id&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("h6",{className:"font-medium text-gray-700 mb-2",children:"만난 사람들:"}),e.previousMeetings&&e.previousMeetings.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"이미 만난 사람들:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.previousMeetings.map(e=>{let t=m.find(t=>t.id===e),s=u[e];if(!t&&!s)return null;let l=t||s,n=!t;return(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(n?"bg-gray-100 text-gray-500 opacity-75":"male"===l.gender?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"),children:[l.name," ",n?"❌":"male"===l.gender?"\uD83D\uDC68":"\uD83D\uDC69"]},e)})})]}),e.currentRoundMeetings&&e.currentRoundMeetings.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-green-600 mb-1",children:"이번 라운드에서 만날 사람들:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.currentRoundMeetings.map(e=>{let t=m.find(t=>t.id===e);return t?(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full border-2 border-dashed ".concat("male"===t.gender?"bg-blue-50 text-blue-700 border-blue-300":"bg-red-50 text-red-700 border-red-300"),children:[t.name," ","male"===t.gender?"\uD83D\uDC68":"\uD83D\uDC69"," ✨"]},e):null})})]}),!(null==(t=e.previousMeetings)?void 0:t.length)&&!(null==(s=e.currentRoundMeetings)?void 0:s.length)&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"아직 만난 사람이 없습니다."})]})]},e.id)})})]}),s.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-4 pb-2 border-b border-pink-200",children:[(0,r.jsx)("span",{className:"text-pink-600 text-xl mr-3",children:"\uD83D\uDC69"}),(0,r.jsxs)("h4",{className:"text-lg font-semibold text-pink-800",children:["여성 참가자 (",s.length,"명)"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>{var t,s;return(0,r.jsxs)("div",{onClick:()=>M(D===e.id?null:e.id),className:"border border-pink-200 rounded-lg p-4 hover:bg-pink-50 cursor-pointer transition-colors",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h5",{className:"font-medium text-gray-800",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-pink-600 bg-pink-100 px-2 py-1 rounded-full",children:["여성 \xb7 ","extrovert"===e.mbti?"외향":"내향"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,r.jsxs)("div",{className:"text-center p-2 bg-blue-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-blue-600",children:e.totalMet}),(0,r.jsx)("div",{className:"text-gray-600",children:"전체 만남"})]}),(0,r.jsxs)("div",{className:"text-center p-2 bg-pink-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-pink-600",children:e.oppositeMet}),(0,r.jsx)("div",{className:"text-gray-600",children:"이성 만남"})]}),(0,r.jsxs)("div",{className:"text-center p-2 bg-green-50 rounded",children:[(0,r.jsx)("div",{className:"font-semibold text-green-600",children:e.newInCurrentRound}),(0,r.jsx)("div",{className:"text-gray-600",children:"이번 라운드"})]})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["현재 그룹: ",e.currentGroupId||"없음"]}),D===e.id&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("h6",{className:"font-medium text-gray-700 mb-2",children:"만난 사람들:"}),e.previousMeetings&&e.previousMeetings.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"이미 만난 사람들:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.previousMeetings.map(e=>{let t=m.find(t=>t.id===e),s=u[e];if(!t&&!s)return null;let l=t||s,n=!t;return(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(n?"bg-gray-100 text-gray-500 opacity-75":"male"===l.gender?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"),children:[l.name," ",n?"❌":"male"===l.gender?"\uD83D\uDC68":"\uD83D\uDC69"]},e)})})]}),e.currentRoundMeetings&&e.currentRoundMeetings.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-green-600 mb-1",children:"이번 라운드에서 만날 사람들:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.currentRoundMeetings.map(e=>{let t=m.find(t=>t.id===e);return t?(0,r.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full border-2 border-dashed ".concat("male"===t.gender?"bg-blue-50 text-blue-700 border-blue-300":"bg-red-50 text-red-700 border-red-300"),children:[t.name," ","male"===t.gender?"\uD83D\uDC68":"\uD83D\uDC69"," ✨"]},e):null})})]}),!(null==(t=e.previousMeetings)?void 0:t.length)&&!(null==(s=e.currentRoundMeetings)?void 0:s.length)&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"아직 만난 사람이 없습니다."})]})]},e.id)})})]})]})})()]})]})})()}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,r.jsx)("button",{onClick:()=>s.push("/"),className:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-md",children:"다음 라운드 준비"}),(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("groupingResult"),localStorage.removeItem("participants"),localStorage.removeItem("currentRound"),localStorage.removeItem("exitedParticipants"),s.push("/")},className:"bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-md",children:"새로운 모임 시작"}),(0,r.jsx)("button",{onClick:()=>window.print(),className:"bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-6 rounded-md",children:"결과 인쇄"})]})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,r.jsx)("p",{children:"결과를 불러오는 중..."})]})})}},5850:(e,t,s)=>{Promise.resolve().then(s.bind(s,3160))}},e=>{e.O(0,[220,441,964,358],()=>e(e.s=5850)),_N_E=e.O()}]);