(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},2024:(e,s,t)=>{"use strict";t.d(s,{default:()=>h});var r=t(5155),l=t(2115),a=t(2099);let i=null,n=e=>{i=e,localStorage.setItem("currentMeetingId",e)},c=()=>{if(i)return i;{let e=localStorage.getItem("currentMeetingId");if(e)return i=e,e}return null},d=async(e,s)=>{if(!a.$G)return console.warn("Supabase가 설정되지 않았습니다. localStorage 모드에서는 모임 생성이 불가능합니다."),null;let t=(0,a.Sw)();if(!t)return null;try{let{data:r,error:l}=await t.from("meetings").insert({user_id:s,name:e,current_round:1}).select().single();if(l)throw l;return n(r.id),r}catch(e){return console.error("모임 생성 중 오류:",e),null}},o=async e=>{let s=(0,a.Sw)();if(!s)return[];try{let{data:t,error:r}=await s.from("meetings").select("*").eq("user_id",e).order("updated_at",{ascending:!1});if(r)throw r;return t||[]}catch(e){return console.error("모임 목록 조회 중 오류:",e),[]}},m=async(e,s)=>{let t=await d(e,s);return t?(n(t.id),t.id):null},x=async e=>(n(e),!0);function u(e){let{user:s,onMeetingSelected:t}=e,[a,i]=(0,l.useState)([]),[n,d]=(0,l.useState)(!0),[u,h]=(0,l.useState)(!1),[b,g]=(0,l.useState)(""),[j,N]=(0,l.useState)(!1),[p,y]=(0,l.useState)(null);(0,l.useEffect)(()=>{f(),y(c())},[]);let f=async()=>{d(!0);try{let e=await o(s.id);i(e)}catch(e){console.error("모임 목록 로드 중 오류:",e)}finally{d(!1)}},v=async()=>{if(b.trim()){N(!0);try{let e=await m(b.trim(),s.id);e?(g(""),h(!1),y(e),await f(),t()):alert("모임 생성 중 오류가 발생했습니다.")}catch(e){console.error("모임 생성 중 오류:",e),alert("모임 생성 중 오류가 발생했습니다.")}finally{N(!1)}}},w=async e=>{try{await x(e),y(e),t()}catch(e){console.error("모임 선택 중 오류:",e),alert("모임 선택 중 오류가 발생했습니다.")}},S=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return n?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"모임 목록을 불러오는 중..."})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83E\uDE91"}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"모임 선택"}),(0,r.jsx)("p",{className:"text-gray-600",children:"기존 모임을 선택하거나 새로운 모임을 만드세요"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("button",{onClick:()=>h(!u),className:"w-full bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600 text-white font-medium py-4 px-6 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"✨"}),(0,r.jsx)("span",{className:"text-lg",children:"새로운 모임 만들기"})]})})}),u&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"새 모임 만들기"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"모임 이름을 입력하세요 (예: 2024년 신년회)",value:b,onChange:e=>g(e.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:e=>"Enter"===e.key&&v()}),(0,r.jsx)("button",{onClick:v,disabled:!b.trim()||j,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white font-medium py-3 px-6 rounded-md transition-colors",children:j?"생성 중...":"생성"}),(0,r.jsx)("button",{onClick:()=>{h(!1),g("")},className:"bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-md transition-colors",children:"취소"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["기존 모임 목록 (",a.length,"개)"]}),0===a.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCDD"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"아직 생성된 모임이 없습니다."}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:'위의 "새로운 모임 만들기" 버튼을 클릭하여 첫 번째 모임을 만들어보세요!'})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>(0,r.jsxs)("div",{className:"border-2 rounded-lg p-4 cursor-pointer transition-all duration-200 ".concat(p===e.id?"border-blue-500 bg-blue-50 shadow-lg":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"),onClick:()=>w(e.id),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-800 flex-1 line-clamp-2",children:e.name}),p===e.id&&(0,r.jsx)("div",{className:"text-blue-500 ml-2",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83C\uDFAF"}),(0,r.jsxs)("span",{children:[e.current_round,"라운드"]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCC5"}),(0,r.jsx)("span",{children:S(e.updated_at)})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["마지막 업데이트: ",S(e.updated_at)]})})]},e.id))})]}),p&&(0,r.jsx)("div",{className:"mt-8 text-center",children:(0,r.jsx)("button",{onClick:t,className:"bg-green-500 hover:bg-green-600 text-white font-medium py-4 px-8 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDE80"}),(0,r.jsx)("span",{children:"선택한 모임으로 시작하기"})]})})})]})})}function h(e){let{children:s}=e,[t,i]=(0,l.useState)(null),[n,d]=(0,l.useState)(!0),[o,m]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!0),[b,g]=(0,l.useState)(""),[j,N]=(0,l.useState)(""),[p,y]=(0,l.useState)(!1),[f,v]=(0,l.useState)(!1),[w,S]=(0,l.useState)(""),C=(0,a.Sw)();if(!a.$G)return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-yellow-50 border-b border-yellow-200",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-800",children:[(0,r.jsx)("span",{children:"⚠️"}),(0,r.jsxs)("span",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"개발 모드:"})," Supabase가 설정되지 않았습니다. localStorage를 사용합니다."]})]})})}),s]});if(!C)return(0,r.jsx)("div",{className:"min-h-screen bg-red-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"❌"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-800 mb-4",children:"설정 오류"}),(0,r.jsx)("p",{className:"text-red-600 mb-6",children:"Supabase 환경변수가 올바르게 설정되지 않았습니다."}),(0,r.jsxs)("div",{className:"text-left bg-gray-100 p-4 rounded-md max-w-md",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:"다음 환경변수를 설정해주세요:"}),(0,r.jsxs)("code",{className:"text-xs",children:["NEXT_PUBLIC_SUPABASE_URL",(0,r.jsx)("br",{}),"NEXT_PUBLIC_SUPABASE_ANON_KEY"]})]})]})});(0,l.useEffect)(()=>{if((async()=>{if(!C)return;let{data:{user:e}}=await C.auth.getUser();i(e),d(!1),e&&I()})(),C){let{data:{subscription:e}}=C.auth.onAuthStateChange((e,s)=>{var t;i(null!=(t=null==s?void 0:s.user)?t:null),d(!1),(null==s?void 0:s.user)?I():(m(!1),h(!1))});return()=>e.unsubscribe()}},[C]);let I=()=>{h(!0),m(!!c()),h(!1)},_=async e=>{if(e.preventDefault(),C){v(!0),S("");try{if(p){let{error:e}=await C.auth.signUp({email:b,password:j});if(e)throw e;S("가입 확인 이메일을 보냈습니다. 이메일을 확인해 주세요.")}else{let{error:e}=await C.auth.signInWithPassword({email:b,password:j});if(e)throw e}}catch(e){S(e.message)}finally{v(!1)}}},k=async()=>{C&&await C.auth.signOut()},E=async()=>{if(C){v(!0);try{let{error:e}=await C.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e}catch(e){S(e.message),v(!1)}}};return n||x?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"로딩 중..."})]})}):t?t&&!o?(0,r.jsx)(u,{user:t,onMeetingSelected:()=>{m(!0)}}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center space-x-3",children:(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["안녕하세요, ",(0,r.jsx)("span",{className:"font-medium text-gray-800",children:t.email}),"님"]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{m(!1)},className:"text-sm text-blue-600 hover:text-blue-700 px-3 py-1 rounded-md hover:bg-blue-50 transition-colors",children:"모임 변경"}),(0,r.jsx)("button",{onClick:k,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded-md hover:bg-gray-100 transition-colors",children:"로그아웃"})]})]})})}),s]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsx)("div",{className:"max-w-md w-full mx-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83E\uDE91"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"모임 자리 배치 프로그램"}),(0,r.jsx)("p",{className:"text-gray-600",children:p?"새 계정을 만들어 시작해보세요":"로그인하여 계속하세요"})]}),(0,r.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"이메일"}),(0,r.jsx)("input",{type:"email",required:!0,value:b,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"your@email.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"비밀번호"}),(0,r.jsx)("input",{type:"password",required:!0,value:j,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••"})]}),w&&(0,r.jsx)("div",{className:"p-3 rounded-md text-sm ".concat(w.includes("확인")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:w}),(0,r.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-md transition-colors",children:f?"처리 중...":p?"회원가입":"로그인"})]}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"또는"})})]}),(0,r.jsxs)("button",{onClick:E,disabled:f,className:"mt-4 w-full bg-white hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-md border border-gray-300 transition-colors flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google로 계속하기"]})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsx)("button",{onClick:()=>{y(!p),S("")},className:"text-sm text-blue-600 hover:text-blue-700",children:p?"이미 계정이 있으신가요? 로그인하기":"계정이 없으신가요? 회원가입하기"})})]})})})}},2099:(e,s,t)=>{"use strict";t.d(s,{$G:()=>n,Sw:()=>c});var r=t(5647),l=t(9535);let a="https://bkislfazojdqypliryye.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJraXNsZmF6b2pkcXlwbGlyeXllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyMzQ4NzMsImV4cCI6MjA2OTgxMDg3M30.Byy9t1UL02S6mSrJ9PxB9ghzerTdjXNzNdory2mK2kw",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJraXNsZmF6b2pkcXlwbGlyeXllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyMzQ4NzMsImV4cCI6MjA2OTgxMDg3M30.Byy9t1UL02S6mSrJ9PxB9ghzerTdjXNzNdory2mK2kw";n&&(0,r.UU)(a,i);let c=()=>n?(0,l.createBrowserClient)(a,i):(console.warn("Supabase is not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables."),null)},3103:()=>{},7025:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,347,23)),Promise.resolve().then(t.bind(t,2024)),Promise.resolve().then(t.t.bind(t,3103,23))}},e=>{e.O(0,[131,535,441,964,358],()=>e(e.s=7025)),_N_E=e.O()}]);